---
title: "A Note on the Dirichlet Distribution"
author: "Joseph Rickert"
date: 2025-08-27
description: "T"
image: ".png"
image-alt: "s"
categories: ""
editor: source
---


In 1839, [Peter Gustav Lejeune Dirichlet](https://en.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlet) was a mathematician attached to the Philosophy department at the University of Berlin working for less than full pay even though he had become a member of the Prussian Academy of Sciences in 1832. Apparently, he wasn't fluent enough in Latin to give the required "Habilitationsschrift" lecture which was requirement for becoming a "full professor". So like many "adjunct professors" today, Dirichlet took a side gig to support his family. He taught math at a military school.  Anyway, I digress. It was about that time that Dirichlet began to work on a problem in celestial mechanics which involved this integral:


$$\quad I := \iiint_{S_s} \frac{dx\, dy\, dz}{\rho^p}$$

Here $(x,y,z) \in R^3$ which is attracted to a point $(a,b,c)$ where $1/\rho^p$ is the force of attraction $(1 < p <3)$ and $\rho^2 := (x - a)^2 + (y - b)^2 + (z - c)^2$ is the Euclidean norm.

After a supernaturally insightful series manipulations detailed by [Gupta and Richards](https://www.jstor.org/stable/1403524), Dirichlet arrived at the following integral 


$$\int_{S_s} \left(1 - \sum_{i=1}^n x_i^2 \right)^{\alpha - 1} x_1^{v_1} x_2^{v_2} \cdots x_n^{v_n} \, dx_1 dx_2 \cdots dx_n = \frac{\Gamma(\alpha) \Gamma\left(\frac{1 + v_1}{2}\right) \cdots \Gamma\left(\frac{1 + v_n}{2}\right)}{\Gamma\left(\alpha + \frac{n + v_1 + \cdots + v_n}{2}\right)}$$
which you will recognize as the normalizing constant for the Dirichlet distribution.

$$f(x_1, \dots, x_K; \alpha_1, \dots, \alpha_K) = 
\frac{1}{\mathrm{B}(\boldsymbol{\alpha})} 
\prod_{i=1}^{K} x_i^{\alpha_i - 1}$$
where

$\mathrm{B}(\boldsymbol{\alpha}) = 
\frac{\prod_{i=1}^{K} \Gamma(\alpha_i)}{\Gamma\left(\sum_{i=1}^{K} \alpha_i\right)}$ and $\alpha_0 = \sum_{i=1}^{K} \alpha_i$

The Dirichlet distribution is a multivariate generalization of the Beta distribution. It is often used in Bayesian statistics as a prior distribution for categorical and multinomial distributions. I highlighted this use in a [previous post](https://rworks.dev/posts/simple-bayesian-model/) where I showed how it can be used to solve a Bayesian model for a three-state Markov chain.


The [Dirichlet distribution](https://en.wikipedia.org/wiki/Dirichlet_distribution) with mean $E[X_i] = \alpha_i / \alpha_0$ and variance $Var[X_i] = \frac{\alpha_i (\alpha_0 - \alpha_i)}{\alpha_0^2 (\alpha_0 + 1)}$ brings together 18th and 19th century work in analysis as exemplified by the Gamma, Beta and digamma functions with early 20th ideas from geometry and topology (the simplex) and modern Bayesian statistics. The simplex idea is particularly interesting. A simplex is a generalization of the notion of a triangle to multiple dimensions. The support of a three dimensional Dirichlet distribution, the points on which the distribution is defined, is a (2)-simplex or triangle. In K dimensions, the Dirichlet distribution is defined over the (K-1)-simplex, which is the set of K-dimensional vectors that sum to 1 and have non-negative components. So, in addition to being the support of the Dirichlet distribution, the simplex is also a natural way to represent probabilities that sum to 1 in multidimensional spaces.


```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
library(ggplot2)
library(gganimate)
library(dplyr)
library(magick)
library(MCMCpack)  # for rdirichlet
library(gtools)  # for ddirichlet
library(patchwork)  # for combining plots

```


When $\alpha_1 = \alpha_2 = \alpha_3 = constant$, the density is symmetric about the middle of the simplex. In the special case when $\alpha = (1, 1, 1)$, the density is uniform over the simplex. When all the $\alpha_i < 1$ the density is concentrated at the vertices of the simplex, and when $\alpha_i > 1$, the density is concentrated in the center of the simplex. The following animation shows how the Dirichlet distribution changes as the common value of $\alpha_i$, called the concentration parameter, move systematically from (1,1,1), the uniform distribution, to (0.1,0.1,0.1). Generally values of the concentration parameter less than 1 lead to distributions concentrated at the vertices of the simplex while values greater than 1 lead to distributions with most of the mass concentrated on a few values. 


## Helper Functions


```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
# This function generates the data frame for the animation
generate_dirichlet_animation_data <- function(alpha1_values, alpha2_values, alpha3_values, n_samples = 2000) {
  library(MCMCpack)
  
  # Triangle vertices
  v1 <- c(1, 0)
  v2 <- c(0, 1)
  v3 <- c(0, 0)
  
  # Projection function
  project_to_triangle <- function(x1, x2, x3) {
    x <- x1 * v1[1] + x2 * v2[1] + x3 * v3[1]
    y <- x1 * v1[2] + x2 * v2[2] + x3 * v3[2]
    data.frame(x = x, y = y)
  }
  
  # Generate animation data
  animation_data <- do.call(rbind, lapply(seq_along(alpha1_values), function(i) {
    alpha <- c(alpha1_values[i], alpha2_values[i], alpha3_values[i])
    samples <- rdirichlet(n_samples, alpha)
    projected <- project_to_triangle(samples[,1], samples[,2], samples[,3])
    projected$alpha1 <- alpha[1]
    projected$alpha2 <- alpha[2]
    projected$alpha3 <- alpha[3]
    projected$frame <- i
    projected
  }))
  
  return(animation_data)
}

# This function creates the animated plot
plot_dirichlet_evolution <- function(animation_data) {
  library(ggplot2)
  library(gganimate)
  library(grid)  # for arrow units
  
  # Triangle vertices
  v1 <- c(1, 0)
  v2 <- c(0, 1)
  v3 <- c(0, 0)
  
  # Label positions
  label_df <- data.frame(
    x = c(v1[1], v2[1], v3[1]),
    y = c(v1[2], v2[2], v3[2]),
    label = c("(1,0,0)", "(0,1,0)", "(0,0,1)"),
    nudge_x = c(-0.08, 0.1, 0),
    nudge_y = c(0, 0, 0.08)
  )
  
  # Triangle outline
  triangle_df <- data.frame(
    x = c(v1[1], v2[1], v3[1], v1[1]),
    y = c(v1[2], v2[2], v3[2], v1[2])
  )
  
  # Build plot
  p_animation <- ggplot(animation_data, aes(x = x, y = y)) +
    geom_point(alpha = 0.3, size = 0.8, color = "steelblue") +
    geom_density_2d(color = "red", alpha = 0.7) +
    geom_path(data = triangle_df, aes(x = x, y = y), color = "black", size = 1) +
    annotate("segment", x = 1, y = 0, xend = 0, yend = 1,
             arrow = arrow(length = unit(0.2, "cm")),
             color = "darkgreen", size = 1.2) +
    xlim(0, 1) + ylim(0, 1) +
    geom_text(data = label_df,
              aes(x = x, y = y, label = label),
              nudge_x = label_df$nudge_x,
              nudge_y = label_df$nudge_y,
              size = 4, fontface = "bold", color = "black") +
    labs(
      title = "Dirichlet Prior Evolution",
      subtitle = "",
      x = "Projected X",
      y = "Projected Y",
      caption = "Transitioning belief over simplex"
    ) +
    theme_minimal() +
    theme(
      plot.title = element_text(size = 16, hjust = 0.5),
      plot.subtitle = element_text(size = 14, hjust = 0.5),
      axis.title = element_text(size = 12),
      plot.caption = element_text(size = 10, hjust = 0.5)
    ) +
    transition_states(frame,
                      transition_length = 1,
                      state_length = 2) +
    ease_aes('sine-in-out')
  
  return(p_animation)
}

```



## Run the Animation

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| 
set.seed(42)

# Parameters
alpha1_values <- seq(1, 0.1, by = -0.01)  # starts high, ends low
alpha2_values <- seq(1, 0.1, by = -0.01)   # starts low, ends high
alpha3_values <- seq(1, 0.1, by = -0.01)   # starts low, ends high

animation_data <- generate_dirichlet_animation_data(alpha1 = alpha1_values, 
                                                    alpha2 = alpha2_values, 
                                                    alpha3 = alpha3_values, 
                                                    n_samples = 2000)

plot_dirichlet_evolution(animation_data)
```






Looking at the first and last frames of the animation shows how the density moves from being uniformly distributed over the simplex to being concentrated at the vertices of the simplex.

:::: {.columns}

::: {.column width="45%"}

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
ggplot(subset(animation_data, frame == 1), aes(x = x, y = y)) +
  geom_point(alpha = 0.3, color = "darkblue") +
  ggtitle("Initial Frame: Uniform Prior: alpha = (1,1,1)")

```


:::

::: {.column width="10%"}

:::

::: {.column width="45%"}

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
  ggplot(subset(animation_data, frame == max(animation_data$frame)), aes(x = x, y = y)) +
  geom_point(alpha = 0.3, color = "red") +
  ggtitle("Final Frame: Concetrated Prior: alpha = (.1,.1,.1)")
```



:::


::::

This concentration of density is even mor apparent in the this following simulation as $alpha$ moves from 0.1 to 5.0.

```{r}
#Define alpha trajectories
alpha1 <- seq(.1, 10, by = 0.1)
alpha2 <- seq(.1, 10, by = 0.1)
alpha3 <- seq(.1, 10, by = 0.1)

animation_data <- generate_dirichlet_animation_data(alpha1, alpha2, alpha3, n_samples = 2000)

plot_dirichlet_evolution(animation_data)

```

Note that this animation shows $\alpha$ passing through 0.5 which is the [Jeffreys prior](https://en.wikipedia.org/wiki/Jeffreys_prior) for the Dirichlet distribution. 



## References

Bela A. Frigyik, Amol Kapila, and Maya R. Gupta, [Introduction to the Dirichlet Distribution and Related Processes](https://web.archive.org/web/20150219021331/https://www.ee.washington.edu/techsite/papers/documents/UWEETR-2010-0006.pdf)

Rameshwar Gupta and Donald St. P. Richards, [The History of the Dirchet and Liouville Distributions](https://en.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlets) international Statistical Review (2001) 

Andrew Heiss, [Guide to understanding the intuition behind the Dirichlet distribution](https://www.andrewheiss.com/blog/2023/09/18/understanding-dirichlet-beta-intuition/#:~:text=The%20distribution%20is%20named%20after,in%20a%20French%2Dsounding%20way.)

Jiayu Lin, [On the Dirichlet Distribution](https://qspace.library.queensu.ca/server/api/core/bitstreams/0a2eb9d4-145a-4e76-84eb-1aa16d6670aa/content)

:::: {.columns}

::: {.column width="45%"}

AAA

:::

::: {.column width="10%"}

:::

::: {.column width="45%"}

BBB


:::


::::
